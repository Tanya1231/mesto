(()=>{"use strict";class e{constructor({data:e,handleCardClick:t,hadleDeleteClick:s},r){this._name=e.name,this._link=e.link,this._handleCardClick=t,this._cardSelector=r,this._card=this._getTemplate()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}_removeCard=()=>{this._card.remove(),this._card=null};_likeCard(e){e.target.classList.toggle("element__vector_active")}_setEventListners(){this._card.querySelector(".element__delete").addEventListener("click",this._removeCard),this._card.querySelector(".element__vector").addEventListener("click",this._likeCard),this._card.querySelector(".element__image").addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}generateCard(){return this._image=this._card.querySelector(".element__image"),this._card.querySelector(".element__title").textContent=this._name,this._image.src=this._link,this._image.alt=this._name,this._setEventListners(),this._card}}class t{constructor(e,t){this.config=e,this._form=t,this._sumbitButton=this._form.querySelector(e.sumbitButton),this._inactiveButtonClass=e.inactiveButtonClass}_setCustomError(e){const t=e.validity;if(e.setCustomValidity(""),t.tooShort||t.tooLong){const t=e.value.length,s=e.getAttribute("minlength");e.setCustomValidity(`Минимальное колличество символов ${s}. Длина текста сейчас ${t} символ`)}}_setFieldError(e){document.querySelector(`#${e.id}-error`).textContent=e.validationMessage}_setButtonState(){this._form.checkValidity()?(this._sumbitButton.classList.remove(this._inactiveButtonClass),this._sumbitButton.removeAttribute("disabled")):this._disableButtonState()}_disableButtonState(){this._sumbitButton.classList.add(this._inactiveButtonClass),this._sumbitButton.setAttribute("disabled",!0)}_handleFormSumbit(e){e.preventDefault(),this._disableButtonState()}_handleFormInput(e){const t=e.target;this._setCustomError(t),this._setFieldError(t),this._setButtonState()}enableValidation=()=>{this._form.addEventListener("submit",(e=>this._handleFormSumbit(e))),this._form.addEventListener("input",(e=>this._handleFormInput(e))),this._setButtonState()}}class s{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItemAppend(e){this._container.append(e)}addItemPrepend(e){this._container.prepend(e)}}class r{constructor(e){this._popup=document.querySelector(e),this.close=this.close.bind(this),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.querySelector(".popup__button-close").addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class n extends r{constructor(e,{formSubmit:t}){super(e),this._formSubmit=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._popup.querySelector(".form__button"),this._inputList=this._popup.querySelectorAll(".form__container")}getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}close(){this._form.reset(),super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._formSubmit(this.getInputValues()),this.close()}))}}const i=document.querySelector(".form"),o=document.querySelector(".form_popup_add-card"),a=document.querySelector(".form__container_type_name"),h=document.querySelector(".form__container_type_info"),l=document.querySelector(".profile__edit-button"),d=document.querySelector(".profile__addbutton"),c=document.querySelector(".profile__avatar"),_=document.querySelector(".form_popup_avatar"),u={form:".form",sumbitButton:".form__button",inactiveButtonClass:"form__button_invalid"},p=new class extends r{constructor(e){super(e),this._picturePopupImage=this._popup.querySelector(".popup__image"),this._popupSubtitle=this._popup.querySelector(".popup__subtitle")}open(e,t){super.open(),this._popupSubtitle.textContent=e,this._picturePopupImage.alt=e,this._picturePopupImage.src=t}}(".popup_open-img");p.setEventListeners();const m=new class{constructor(e,t,s){this._profileName=document.querySelector(e),this._profileInfo=document.querySelector(t),this._profileAvatar=document.querySelector(s),this._profileId=""}getUserInfo(){return{name:this._profileName.textContent,about:this._profileInfo.textContent,avatar:this._profileAvatar.src,id:this._profileId}}setUserInfo(e,t,s){this._profileName.textContent=e,this._profileInfo.textContent=t,this._profileId=s}getUserId(){return this._userId}setUserAvatar(e){this._profileAvatar.src=e}}(".profile__title",".profile__subtitle",".profile__avatar"),f=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_handleResponse(e){return e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}setUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}setUserAvatar({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}addCard({name:e,link:t,alt:s}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t,alt:s})}).then(this._handleResponse)}putLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}removeLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-47",headers:{authorization:"0162be33-26fc-4582-97e8-0d78f4ad20d1","Content-Type":"application/json"}});f.getUserInfo().then((e=>{m.setUserInfo(e.name,e.about,e._id)}));const v=new n(".popup_type_profile",{formSubmit:({profileName:e,profileInfo:t})=>f.setUserInfo({name:e,about:t}).then((e=>{m.setUserInfo(e.name,e.about)})).catch((e=>console.log(e)))});v.setEventListeners(),l.addEventListener("click",(()=>{const e=m.getUserInfo();a.value=e.name,h.value=e.about,v.open()})),f.getUserInfo().then((e=>{m.setUserAvatar(e.avatar)}));const b=new n(".popup_type_avatar",{formSubmit:({profileAvatar:e})=>f.setUserAvatar({avatar:e}).then((e=>{m.setUserAvatar(c.src=e.avatar)})).catch((e=>console.error(e)))});b.setEventListeners(),f.getInitialCards().then((t=>{const r=new s({items:t,renderer:t=>{const s=new e({data:t,handleCardClick:(e,t)=>{p.open(e,t)}},".elements").generateCard();r.addItemAppend(s)}},"#card");r.renderItems();const i=new n(".popup_add_card",{formSubmit:t=>{f.addCard(t).then((t=>{const s=new e({data:t,handleCardClick:(e,t)=>{p.open(e,t)}}).generateCard();r.addItemPrepend(s)})).catch((e=>console.log(e)))}});i.setEventListeners(),d.addEventListener("click",(()=>{i.open()}))})),new t(u,o).enableValidation(),new t(u,i).enableValidation(),new t(u,_).enableValidation(),c.addEventListener("click",(()=>{b.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ekUsRUFBYyxrQkFBbUIsQ0FDdERDLFdBQWFsQixJQUNYcUQsRUFBSW1CLFFBQVF4RSxHQUNYa0UsTUFBTWxFLElBQ0wsTUFRSXlGLEVBUlMsSUFBSW5LLEVBQ2YsQ0FDRUUsS0FBTXdFLEVBQ052RSxnQkFBaUIsQ0FBQ0ssRUFBTUUsS0FDdEJtRyxFQUFTdkIsS0FBSzlFLEVBQU1FLEVBQXBCLElBSWlCa0IsZUFDekJzSSxFQUFTcEYsZUFBZXFGLEVBQXhCLElBRUZSLE9BQU9NLEdBQVVKLFFBQVFDLElBQUlHLElBYjNCLElBZ0JKRyxFQUFXM0Usb0JBS1hpQixFQUFXL0UsaUJBQWlCLFNBSEYsS0FDeEJ5SSxFQUFXOUUsTUFBWCxHQUVGLElBUWlCLElBQUlyRCxFQUFjQyxFQUFRb0UsR0FDbEN0QyxtQkFFWSxJQUFJL0IsRUFBY0MsRUFBUW1FLEdBQ2xDckMsbUJBRU8sSUFBSS9CLEVBQWNDLEVBQVEwRSxHQUNsQzVDLG1CQU1oQjJDLEVBQVNoRixpQkFBaUIsU0FBUyxLQUNqQ3FJLEVBQVkxRSxNQUFaLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL3V0aWxzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUNhcmRDbGljaywgaGFkbGVEZWxldGVDbGlja30sIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICAvL3RoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7ICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2NhcmQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gIH1cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBlbGVtZW50VGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3Rvcik7XHJcbiAgICBjb25zdCBjYXJkc0VsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGUuY29udGVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZHNFbGVtZW50O1xyXG4gIH1cclxuICBfcmVtb3ZlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkID0gbnVsbDtcclxuICB9O1xyXG4gIF9saWtlQ2FyZChldnQpIHtcclxuICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRfX3ZlY3Rvcl9hY3RpdmVcIik7XHJcbiAgfVxyXG4gIF9zZXRFdmVudExpc3RuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19kZWxldGVcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9yZW1vdmVDYXJkKTtcclxuICAgIHRoaXMuX2NhcmRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdmVjdG9yXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fbGlrZUNhcmQpO1xyXG4gICAgdGhpcy5fY2FyZFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdG5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcclxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XHJcbiAgICB0aGlzLl9zdW1iaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1bWJpdEJ1dHRvbik7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICAvKnRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19jb250YWluZXJcIilcclxuICAgICk7Ki9cclxuICB9XHJcbiAgX3NldEN1c3RvbUVycm9yKGlucHV0KSB7XHJcbiAgICBjb25zdCB2YWxpZGl0eSA9IGlucHV0LnZhbGlkaXR5O1xyXG4gICAgaW5wdXQuc2V0Q3VzdG9tVmFsaWRpdHkoXCJcIik7XHJcbiAgICBpZiAodmFsaWRpdHkudG9vU2hvcnQgfHwgdmFsaWRpdHkudG9vTG9uZykge1xyXG4gICAgICBjb25zdCBjdXJyZW50TGVuZ3RoID0gaW5wdXQudmFsdWUubGVuZ3RoO1xyXG4gICAgICBjb25zdCBtaW4gPSBpbnB1dC5nZXRBdHRyaWJ1dGUoXCJtaW5sZW5ndGhcIik7XHJcbiAgICAgIGlucHV0LnNldEN1c3RvbVZhbGlkaXR5KFxyXG4gICAgICAgIGDQnNC40L3QuNC80LDQu9GM0L3QvtC1INC60L7Qu9C70LjRh9C10YHRgtCy0L4g0YHQuNC80LLQvtC70L7QsiAke21pbn0uINCU0LvQuNC90LAg0YLQtdC60YHRgtCwINGB0LXQudGH0LDRgSAke2N1cnJlbnRMZW5ndGh9INGB0LjQvNCy0L7Qu2BcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcbiAgX3NldEZpZWxkRXJyb3IoaW5wdXQpIHtcclxuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIHNwYW4udGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICB9XHJcbiAgX3NldEJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaXNWYWxpZCA9IHRoaXMuX2Zvcm0uY2hlY2tWYWxpZGl0eSgpO1xyXG4gICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VtYml0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1bWJpdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBfZGlzYWJsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgdGhpcy5fc3VtYml0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdW1iaXRCdXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVGb3JtU3VtYml0KGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB0aGlzLl9kaXNhYmxlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbiAgX2hhbmRsZUZvcm1JbnB1dChldnQpIHtcclxuICAgIGNvbnN0IGlucHV0ID0gZXZ0LnRhcmdldDtcclxuICAgIC8v0LjRidC10Lwg0L3QtSDQstCw0LvQuNC00L3Ri9C1INC/0L7Qu9GPINC4INGD0YHRgtCw0L3QvtCy0LjRgtGMINC+0YjQuNCx0LrQuFxyXG4gICAgdGhpcy5fc2V0Q3VzdG9tRXJyb3IoaW5wdXQpO1xyXG4gICAgLy8g0L/QvtC60LDQt9GL0LLQsNC10Lwg0L7RiNC40LHQutC4XHJcbiAgICB0aGlzLl9zZXRGaWVsZEVycm9yKGlucHV0KTtcclxuICAgIC8v0LTQsNC60YLQuNCy0LDRhtC40Y8g0LrQvdC+0L/QutC4XHJcbiAgICB0aGlzLl9zZXRCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBldnQgPT4gdGhpcy5faGFuZGxlRm9ybVN1bWJpdChldnQpKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGV2dCA9PiB0aGlzLl9oYW5kbGVGb3JtSW5wdXQoZXZ0KSk7XHJcbiAgICB0aGlzLl9zZXRCdXR0b25TdGF0ZSgpO1xyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgYWRkSXRlbUFwcGVuZChlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuICBhZGRJdGVtUHJlcGVuZChlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSBldnQgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uLWNsb3NlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGV2dCA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ICE9PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgeyBmb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybVN1Ym1pdCA9IGZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2NvbnRhaW5lclwiKTtcclxuICB9XHJcbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4gKGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpKTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZ0ID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1TdWJtaXQodGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8vL2V4cG9ydCBjb25zdCBwb3B1cFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9wcm9maWxlJyk7XHJcbi8vL2V4cG9ydCBjb25zdCBwb3B1cEFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfYWRkX2NhcmQnKTtcclxuLy8vZXhwb3J0IGNvbnN0IHBvcHVwSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9vcGVuLWltZ1wiKTtcclxuXHJcbi8vL2V4cG9ydCBjb25zdCBidXR0b25DbG9zZVByb2ZpbGUgPSBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24tY2xvc2UnKTtcclxuLy8vZXhwb3J0IGNvbnN0IGJ1dHRvbkNsb3NlQ2FyZCA9IHBvcHVwQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbi1jbG9zZScpO1xyXG4vLy9leHBvcnQgY29uc3QgYnV0dG9uQ2xvc2VJbWcgPSBwb3B1cEltZy5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbi1jbG9zZScpO1xyXG5cclxuXHJcbi8vL2V4cG9ydCBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50cycpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1Qcm9maWxlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX3BvcHVwX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fY29udGFpbmVyX3R5cGVfbmFtZScpO1xyXG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fY29udGFpbmVyX3R5cGVfaW5mbycpO1xyXG4vLy9leHBvcnQgY29uc3QgbmFtZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fY29udGFpbmVyX3R5cGVfaW5mJyk7XHJcbi8vL2V4cG9ydCBjb25zdCBsaW5rRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19jb250YWluZXJfdHlwZV9zcmMnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBidXR0b25Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbi8vL2V4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG4vLy9leHBvcnQgY29uc3QgcHJvZmlsZUluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkYnV0dG9uJyk7XHJcblxyXG4vLy9leHBvcnQgY29uc3QgcGljdHVyZVBvcHVwSW1hZ2UgPSBwb3B1cEltZy5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuLy8vZXhwb3J0IGNvbnN0IHBvcHVwU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zdWJ0aXRsZVwiKTtcclxuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGZvcm1Qcm9maWxlRWRpdCxcclxuICBmb3JtQWRkQ2FyZCxcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXQsXHJcbiAgYnV0dG9uUHJvZmlsZSxcclxuICBidXR0b25DYXJkLFxyXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzLmpzXCI7XHJcblxyXG5cclxuY29uc3QgYXZhdGFya2EgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyJyk7XHJcbmNvbnN0IGZvcm1BdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9wb3B1cF9hdmF0YXInKTtcclxuLy8gZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19kZWxldGUnKTtcclxuLy9jb25zdCBwb3B1cERlbGV0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2NvbmZpcm0nKTtcclxuXHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybTogXCIuZm9ybVwiLFxyXG4gIHN1bWJpdEJ1dHRvbjogXCIuZm9ybV9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25faW52YWxpZFwiLFxyXG59O1xyXG5cclxuY29uc3QgYmlnSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfb3Blbi1pbWdcIik7XHJcbmJpZ0ltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLCBcIi5wcm9maWxlX19hdmF0YXJcIik7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpICh7XHJcbiAgYmFzZVVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNDcnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiAnMDE2MmJlMzMtMjZmYy00NTgyLTk3ZTgtMGQ3OGY0YWQyMGQxJyxcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuXHJcbi8vLyDQv9GA0L7RhNC40LvRjFxyXG5cclxuYXBpLmdldFVzZXJJbmZvKClcclxuLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlc3VsdC5uYW1lLCByZXN1bHQuYWJvdXQsIHJlc3VsdC5faWQpO1xyXG59KVxyXG5cclxuY29uc3QgcG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9wcm9maWxlXCIsIHsgXHJcbmZvcm1TdWJtaXQ6KHtwcm9maWxlTmFtZSwgcHJvZmlsZUluZm99KSA9PlxyXG5hcGkuc2V0VXNlckluZm8oe1xyXG4gIG5hbWU6IHByb2ZpbGVOYW1lLFxyXG4gIGFib3V0OiBwcm9maWxlSW5mb1xyXG59KS50aGVuKChyZXN1bHQpID0+IHtcclxudXNlckluZm8uc2V0VXNlckluZm8ocmVzdWx0Lm5hbWUsIHJlc3VsdC5hYm91dCk7IFxyXG59KVxyXG4uY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxufSlcclxucG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7IFxyXG5cclxuXHJcblxyXG5jb25zdCBvcGVuUHJvZmlsZSA9ICgpID0+IHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcclxuICBqb2JJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xyXG4gIHBvcHVwRm9ybS5vcGVuKCk7XHJcbn07XHJcbmJ1dHRvblByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9maWxlKTtcclxuXHJcbi8vLyDQsNCy0LDRgtCw0YBcclxuXHJcblxyXG5hcGkuZ2V0VXNlckluZm8oKVxyXG4udGhlbigocmVzdWx0KSA9PiB7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXN1bHQuYXZhdGFyKTtcclxufSlcclxuXHJcblxyXG5jb25zdCBwb3B1cEF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9hdmF0YXInLCB7XHJcbiAgZm9ybVN1Ym1pdDogKHsgcHJvZmlsZUF2YXRhciB9KSA9PiBcclxuICAgIGFwaS5zZXRVc2VyQXZhdGFyKHtcclxuICAgICAgYXZhdGFyOiBwcm9maWxlQXZhdGFyXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGF2YXRhcmthLnNyYyA9IHJlc3VsdC5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbn0pXHJcbnBvcHVwQXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5cclxuXHJcbi8vLyDQvtGC0YDQuNGB0L7QstC60LAg0LrQsNGA0YLQvtGH0LXQuiDQuCDQtNC+0LHQsNCy0LvQtdC90LjQtVxyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiByZXMsXHJcbiAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBkYXRhOiBpdGVtLFxyXG4gICAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogKG5hbWUsIGxpbmspID0+IHtcclxuICAgICAgICAgICAgICAgIGJpZ0ltYWdlLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCIuZWxlbWVudHNcIlxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW1BcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgXCIjY2FyZFwiXHJcbiAgICApO1xyXG4gICAgY2FyZExpc3QucmVuZGVySXRlbXMoKTtcclxuIFxyXG5cclxuICAgIGNvbnN0IGNyZWF0ZUNhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hZGRfY2FyZFwiLCB7XHJcbiAgICAgIGZvcm1TdWJtaXQ6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgYXBpLmFkZENhcmQoaXRlbSlcclxuICAgICAgICAudGhlbigoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgZGF0YTogaXRlbSxcclxuICAgICAgICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6IChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBiaWdJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgICAgIGNhcmRMaXN0LmFkZEl0ZW1QcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9KVxyXG4gICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGVycm9yKSlcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgY3JlYXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgXHJcbiAgICBjb25zdCBoYW5kbGVBZGRDYXJkRm9ybSA9ICgpID0+IHtcclxuICAgICAgY3JlYXRlQ2FyZC5vcGVuKCk7XHJcbiAgICB9O1xyXG4gICAgYnV0dG9uQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQ2FyZEZvcm0pO1xyXG4gIH0pO1xyXG5cclxuICBcclxuXHJcbi8vL9Cy0LDQu9C40LTQsNGG0LjRj1xyXG5cclxuXHJcbmNvbnN0IGZvcm1BZGRWYWxpZCA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUFkZENhcmQpO1xyXG5mb3JtQWRkVmFsaWQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZm9ybVByb2ZpbGVWYWxpZCA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybVByb2ZpbGVFZGl0KTtcclxuZm9ybVByb2ZpbGVWYWxpZC5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBmb3JtQXZhdGFyVmFsaWQgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1BdmF0YXIpO1xyXG5mb3JtQXZhdGFyVmFsaWQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuXHJcblxyXG4vLy8g0YHQu9GD0YjQsNGC0LXQu9C4XHJcblxyXG5hdmF0YXJrYS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHBvcHVwQXZhdGFyLm9wZW4oKVxyXG4gIH0pXHJcblxyXG4vKmRlbGV0ZUNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cERlbGV0ZS5vcGVuKClcclxufSkqLyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BpY3R1cmVQb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wb3B1cFN1YnRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VidGl0bGVcIik7XHJcbiAgfVxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBTdWJ0aXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9waWN0dXJlUG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcGljdHVyZVBvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHByb2ZpbGVOYW1lLCBwcm9maWxlSW5mbywgcHJvZmlsZUF2YXRhcikge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVJbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlSW5mbyk7XHJcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVJZCA9IFwiXCI7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICBuYW1lIDogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgYWJvdXQgOiB0aGlzLl9wcm9maWxlSW5mby50ZXh0Q29udGVudCxcclxuICAgICBhdmF0YXI6IHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjLFxyXG4gICAgIGlkOiB0aGlzLl9wcm9maWxlSWRcclxuICAgIH1cclxuICB9XHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQsIGlkKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlSW5mby50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgdGhpcy5fcHJvZmlsZUlkID0gaWQ7XHJcbiAgICAvL3RoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgfVxyXG4gIGdldFVzZXJJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl91c2VySWQ7XHJcbiAgfVxyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnN9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xyXG4gICAgICBpZihyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8oIHtuYW1lLCBhYm91dH0gKSB7XHJcbiAgICAgIC8vbG9hZGluZyh0cnVlKTtcclxuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICBhYm91dFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcbiAgICBcclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgICAgICAgIFxyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGF2YXRhclxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ2FyZCh7IG5hbWUsIGxpbmssIGFsdCB9KSB7XHJcbiAgICAgIC8vbG9hZGluZyh0cnVlKTtcclxuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbmFtZSxcclxuICAgICAgICAgIGxpbmssXHJcbiAgICAgICAgICBhbHRcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIHB1dExpa2UoY2FyZElEKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJRH1gLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQgKGNhcmRJRCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVMaWtlKGNhcmRJRCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSUR9YCwge1xyXG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcclxuICAgIH0gXHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImhhZGxlRGVsZXRlQ2xpY2siLCJjYXJkU2VsZWN0b3IiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkU2VsZWN0b3IiLCJfY2FyZCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfcmVtb3ZlQ2FyZCIsInJlbW92ZSIsIl9saWtlQ2FyZCIsImV2dCIsInRhcmdldCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9zZXRFdmVudExpc3RuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdlbmVyYXRlQ2FyZCIsIl9pbWFnZSIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm0iLCJfZm9ybSIsIl9zdW1iaXRCdXR0b24iLCJzdW1iaXRCdXR0b24iLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfc2V0Q3VzdG9tRXJyb3IiLCJpbnB1dCIsInZhbGlkaXR5Iiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJ0b29TaG9ydCIsInRvb0xvbmciLCJjdXJyZW50TGVuZ3RoIiwidmFsdWUiLCJsZW5ndGgiLCJtaW4iLCJnZXRBdHRyaWJ1dGUiLCJfc2V0RmllbGRFcnJvciIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfc2V0QnV0dG9uU3RhdGUiLCJjaGVja1ZhbGlkaXR5IiwicmVtb3ZlQXR0cmlidXRlIiwiX2Rpc2FibGVCdXR0b25TdGF0ZSIsImFkZCIsInNldEF0dHJpYnV0ZSIsIl9oYW5kbGVGb3JtU3VtYml0IiwicHJldmVudERlZmF1bHQiLCJfaGFuZGxlRm9ybUlucHV0IiwiZW5hYmxlVmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJmb3JFYWNoIiwiaXRlbSIsImFkZEl0ZW1BcHBlbmQiLCJlbGVtZW50IiwiYXBwZW5kIiwiYWRkSXRlbVByZXBlbmQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiY2xvc2UiLCJiaW5kIiwiX2hhbmRsZUVzY0Nsb3NlIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwicmVzZXQiLCJmb3JtUHJvZmlsZUVkaXQiLCJmb3JtQWRkQ2FyZCIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwiYnV0dG9uUHJvZmlsZSIsImJ1dHRvbkNhcmQiLCJhdmF0YXJrYSIsImZvcm1BdmF0YXIiLCJiaWdJbWFnZSIsIl9waWN0dXJlUG9wdXBJbWFnZSIsIl9wb3B1cFN1YnRpdGxlIiwidXNlckluZm8iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVJbmZvIiwicHJvZmlsZUF2YXRhciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSW5mbyIsIl9wcm9maWxlQXZhdGFyIiwiX3Byb2ZpbGVJZCIsImdldFVzZXJJbmZvIiwiYWJvdXQiLCJhdmF0YXIiLCJzZXRVc2VySW5mbyIsImdldFVzZXJJZCIsIl91c2VySWQiLCJzZXRVc2VyQXZhdGFyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwidGhlbiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsInB1dExpa2UiLCJjYXJkSUQiLCJkZWxldGVDYXJkIiwicmVtb3ZlTGlrZSIsImF1dGhvcml6YXRpb24iLCJyZXN1bHQiLCJfaWQiLCJwb3B1cEZvcm0iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJ1c2VyRGF0YSIsInBvcHVwQXZhdGFyIiwiZXJyb3IiLCJjYXJkTGlzdCIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCJdLCJzb3VyY2VSb290IjoiIn0=