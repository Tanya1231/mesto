(()=>{"use strict";class e{constructor(e,t){this.config=e,this._form=t,this._sumbitButton=this._form.querySelector(e.sumbitButton),this._inactiveButtonClass=e.inactiveButtonClass}_setCustomError(e){const t=e.validity;if(e.setCustomValidity(""),t.tooShort||t.tooLong){const t=e.value.length,s=e.getAttribute("minlength");e.setCustomValidity(`Минимальное колличество символов ${s}. Длина текста сейчас ${t} символ`)}}_setFieldError(e){document.querySelector(`#${e.id}-error`).textContent=e.validationMessage}_setButtonState(){this._form.checkValidity()?(this._sumbitButton.classList.remove(this._inactiveButtonClass),this._sumbitButton.removeAttribute("disabled")):this._disableButtonState()}_disableButtonState(){this._sumbitButton.classList.add(this._inactiveButtonClass),this._sumbitButton.setAttribute("disabled",!0)}_handleFormSumbit(e){e.preventDefault(),this._disableButtonState()}_handleFormInput(e){const t=e.target;this._setCustomError(t),this._setFieldError(t),this._setButtonState()}enableValidation=()=>{this._form.addEventListener("submit",(e=>this._handleFormSumbit(e))),this._form.addEventListener("input",(e=>this._handleFormInput(e))),this._setButtonState()}}class t{constructor({data:e,userId:t,handleCardClick:s,hadleLikeClick:i,hadleDisLikeClick:r,handleDeleteCard:n},o){this._name=e.name,this._link=e.link,this._likes=e.likes,this._cardOwnerId=e.owner._id,this._userId=t,this._cardId=e._id,this._handleCardClick=s,this._hadleLikeClick=i,this._hadleDisLikeClick=r,this._handleDeleteCard=n,this._cardSelector=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}removeCard=()=>{this._card.remove(),this._card=null};_сardLike(){this._likes.some((e=>this._userId===e._id))&&this._likeButton.classList.add("element__vector_active")}handleLikeCard(e){this._likes=e.likes,this._likesCounter.textContent=this._likes.length,this._likeButton.classList.toggle("element__vector_active")}_deleteCard(){this._userId!==this._cardOwnerId&&this._deleteButton.remove()}_setEventListners(){this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this._cardId)})),this._likeButton.addEventListener("click",(()=>{this._likeButton.classList.contains("element__vector_active")?this._hadleDisLikeClick(this._cardId):this._hadleLikeClick(this._cardId)})),this._image.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}generateCard(){return this._card=this._getTemplate(),this._likeButton=this._card.querySelector(".element__vector"),this._likesCounter=this._card.querySelector(".element__vector-counter"),this._deleteButton=this._card.querySelector(".element__delete"),this._image=this._card.querySelector(".element__image"),this._card.querySelector(".element__title").textContent=this._name,this._likesCounter.textContent=this._likes.length,this._image.src=this._link,this._image.alt=this._name,this._сardLike(),this._deleteCard(),this._setEventListners(),this._card}}class s{constructor(e){this._popup=document.querySelector(e),this.close=this.close.bind(this),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.querySelector(".popup__button-close").addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class i extends s{constructor(e,{formSubmit:t}){super(e),this._formSubmit=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._popup.querySelector(".form__button"),this._inputList=this._popup.querySelectorAll(".form__container")}getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}close(){this._form.reset(),super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._formSubmit(this.getInputValues()),this.close()}))}loading(e){e&&(this._submitButton.textContent="Сохранение...")}}const r=document.querySelector(".form"),n=document.querySelector(".form_popup_add-card"),o=document.querySelector(".form__container_type_name"),a=document.querySelector(".form__container_type_info"),l=document.querySelector(".profile__edit-button"),d=document.querySelector(".profile__addbutton"),h=document.querySelector(".profile__avatar"),c=document.querySelector(".form_popup_avatar"),_={form:".form",sumbitButton:".form__button",inactiveButtonClass:"form__button_invalid"},u=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_handleResponse(e){return e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`)}async getUserInfo(){const e=await fetch(`${this._baseUrl}/users/me`,{headers:this._headers});return this._handleResponse(e)}async editUserInfo(e){const t=await fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})});return this._handleResponse(t)}async getInitialCards(){const e=await fetch(`${this._baseUrl}/cards`,{headers:this._headers});return this._handleResponse(e)}async setUserAvatar(e){const t=await fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})});return this._handleResponse(t)}async addCard(e){const t=await fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})});return this._handleResponse(t)}async putLike(e){const t=await fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers});return this._handleResponse(t)}async deleteCard(e){const t=await fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers});this._handleResponse(t)}async removeLike(e){const t=await fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers});return this._handleResponse(t)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-47",headers:{authorization:"0162be33-26fc-4582-97e8-0d78f4ad20d1","Content-Type":"application/json"}}),p=new class extends s{constructor(e){super(e),this._picturePopupImage=this._popup.querySelector(".popup__image"),this._popupSubtitle=this._popup.querySelector(".popup__subtitle")}open(e,t){super.open(),this._popupSubtitle.textContent=e,this._picturePopupImage.alt=e,this._picturePopupImage.src=t}}(".popup_open-img"),m=new class extends s{constructor(e){super(e),this._form=this._popup.querySelector(".form")}submitHandle(e){this._handleSubmit=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}(".popup_type_delete"),f=new class{constructor({profileName:e,profileInfo:t,profileAvatar:s}){this._profileName=document.querySelector(e),this._profileInfo=document.querySelector(t),this._profileAvatar=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,about:this._profileInfo.textContent}}setUserInfo(e){this._profileName.textContent=e.name,this._profileInfo.textContent=e.about,this._profileAvatar.src=e.avatar}setUserAvatar(e){this._profileAvatar.src=e.avatar}}({profileName:".profile__title",profileInfo:".profile__subtitle",profileAvatar:".profile__avatar"}),v=new i(".popup_type_profile",{formSubmit:e=>{v.loading(!0),u.editUserInfo(e).then((e=>{f.setUserInfo(e)})).catch((e=>{console.log(e)}))}});v.setEventListeners();const b=e=>{const s=new t({data:e,userId:L,handleCardClick:(e,t)=>{p.open(e,t)},hadleLikeClick:e=>{u.putLike(e).then((e=>{s.handleLikeCard(e)})).catch((e=>{console.log(e)}))},hadleDisLikeClick:e=>{u.removeLike(e).then((e=>{s.handleLikeCard(e)})).catch((e=>{console.log(e)}))},handleDeleteCard:e=>{m.open(),m.submitHandle((()=>{u.deleteCard(e).then((()=>{m.close(),s.removeCard(s)})).catch((e=>{console.log(e)}))}))}},"#card"),i=s.generateCard();return C.addItemPrepend(i),i},C=new class{constructor({renderer:e},t){this._renderer=e,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItemAppend(e){this._container.append(e)}addItemPrepend(e){this._container.prepend(e)}}({renderer:e=>{C.addItemPrepend(b(e))}},".elements"),k=new i(".popup_add_card",{formSubmit:e=>{k.loading(!0),u.addCard(e).then((e=>{b(e)})).catch((e=>{console.log(e)}))}}),y=new i(".popup_type_avatar",{formSubmit:e=>{y.loading(!0),u.setUserAvatar(e).then((e=>{f.setUserAvatar(e)})).catch((e=>{console.log(e)}))}});let L;new e(_,n).enableValidation(),new e(_,r).enableValidation(),new e(_,c).enableValidation(),Promise.all([u.getInitialCards(),u.getUserInfo()]).then((e=>{const[t,s]=e;L=s._id,C.renderItems(t.reverse()),f.setUserInfo(s),f.setUserAvatar(s)})),m.setEventListeners(),y.setEventListeners(),k.setEventListeners(),p.setEventListeners(),l.addEventListener("click",(()=>{const e=f.getUserInfo();o.value=e.name,a.value=e.about,v.open()})),d.addEventListener("click",(()=>{k.open()})),h.addEventListener("click",(()=>{y.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVEzRixNQUFSLElBdUVGd0IsRUFBUzNFLGlCQUFpQixTQUFTLEtBQ2pDNEcsRUFBY3pELE1BQWQsRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy91dGlscy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBEZWxldGUuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKSB7XHJcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gICAgdGhpcy5fc3VtYml0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdW1iaXRCdXR0b24pO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gIH1cclxuICBfc2V0Q3VzdG9tRXJyb3IoaW5wdXQpIHtcclxuICAgIGNvbnN0IHZhbGlkaXR5ID0gaW5wdXQudmFsaWRpdHk7XHJcbiAgICBpbnB1dC5zZXRDdXN0b21WYWxpZGl0eShcIlwiKTtcclxuICAgIGlmICh2YWxpZGl0eS50b29TaG9ydCB8fCB2YWxpZGl0eS50b29Mb25nKSB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnRMZW5ndGggPSBpbnB1dC52YWx1ZS5sZW5ndGg7XHJcbiAgICAgIGNvbnN0IG1pbiA9IGlucHV0LmdldEF0dHJpYnV0ZShcIm1pbmxlbmd0aFwiKTtcclxuICAgICAgaW5wdXQuc2V0Q3VzdG9tVmFsaWRpdHkoXHJcbiAgICAgICAgYNCc0LjQvdC40LzQsNC70YzQvdC+0LUg0LrQvtC70LvQuNGH0LXRgdGC0LLQviDRgdC40LzQstC+0LvQvtCyICR7bWlufS4g0JTQu9C40L3QsCDRgtC10LrRgdGC0LAg0YHQtdC50YfQsNGBICR7Y3VycmVudExlbmd0aH0g0YHQuNC80LLQvtC7YFxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuICBfc2V0RmllbGRFcnJvcihpbnB1dCkge1xyXG4gICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xyXG4gICAgc3Bhbi50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gIH1cclxuICBfc2V0QnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5fZm9ybS5jaGVja1ZhbGlkaXR5KCk7XHJcbiAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICB0aGlzLl9zdW1iaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VtYml0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9kaXNhYmxlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICB0aGlzLl9zdW1iaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1bWJpdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICB9XHJcbiAgX2hhbmRsZUZvcm1TdW1iaXQoZXZ0KSB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2Rpc2FibGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuICBfaGFuZGxlRm9ybUlucHV0KGV2dCkge1xyXG4gICAgY29uc3QgaW5wdXQgPSBldnQudGFyZ2V0O1xyXG4gICAgLy/QuNGJ0LXQvCDQvdC1INCy0LDQu9C40LTQvdGL0LUg0L/QvtC70Y8g0Lgg0YPRgdGC0LDQvdC+0LLQuNGC0Ywg0L7RiNC40LHQutC4XHJcbiAgICB0aGlzLl9zZXRDdXN0b21FcnJvcihpbnB1dCk7XHJcbiAgICAvLyDQv9C+0LrQsNC30YvQstCw0LXQvCDQvtGI0LjQsdC60LhcclxuICAgIHRoaXMuX3NldEZpZWxkRXJyb3IoaW5wdXQpO1xyXG4gICAgLy/QtNCw0LrRgtC40LLQsNGG0LjRjyDQutC90L7Qv9C60LhcclxuICAgIHRoaXMuX3NldEJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGV2dCA9PiB0aGlzLl9oYW5kbGVGb3JtU3VtYml0KGV2dCkpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZXZ0ID0+IHRoaXMuX2hhbmRsZUZvcm1JbnB1dChldnQpKTtcclxuICAgIHRoaXMuX3NldEJ1dHRvblN0YXRlKCk7XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHtcclxuICAgICAgZGF0YSxcclxuICAgICAgdXNlcklkLFxyXG4gICAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICAgIGhhZGxlTGlrZUNsaWNrLFxyXG4gICAgICBoYWRsZURpc0xpa2VDbGljayxcclxuICAgICAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICAgIH0sXHJcbiAgICBjYXJkU2VsZWN0b3JcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fY2FyZE93bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFkbGVMaWtlQ2xpY2sgPSBoYWRsZUxpa2VDbGljaztcclxuICAgIHRoaXMuX2hhZGxlRGlzTGlrZUNsaWNrID0gaGFkbGVEaXNMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgZWxlbWVudFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xyXG4gICAgY29uc3QgY2FyZHNFbGVtZW50ID0gZWxlbWVudFRlbXBsYXRlLmNvbnRlbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRzRWxlbWVudDtcclxuICB9XHJcbiAgcmVtb3ZlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkID0gbnVsbDtcclxuICB9O1xyXG4gIF/RgWFyZExpa2UoKSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuX2xpa2VzLnNvbWUodXNlciA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJZCA9PT0gdXNlci5faWQ7XHJcbiAgICAgIH0pXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZWxlbWVudF9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcbiAgaGFuZGxlTGlrZUNhcmQoZGF0YSkge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fbGlrZXNDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fdmVjdG9yX2FjdGl2ZVwiKTtcclxuICB9XHJcbiAgX2RlbGV0ZUNhcmQoKSB7XHJcbiAgICBpZiAodGhpcy5fdXNlcklkICE9PSB0aGlzLl9jYXJkT3duZXJJZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9zZXRFdmVudExpc3RuZXJzKCkge1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZElkKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJlbGVtZW50X192ZWN0b3JfYWN0aXZlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5faGFkbGVEaXNMaWtlQ2xpY2sodGhpcy5fY2FyZElkKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9oYWRsZUxpa2VDbGljayh0aGlzLl9jYXJkSWQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2ltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdmVjdG9yXCIpO1xyXG4gICAgdGhpcy5fbGlrZXNDb3VudGVyID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3ZlY3Rvci1jb3VudGVyXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2RlbGV0ZVwiKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2xpa2VzQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5f0YFhcmRMaWtlKCk7XHJcbiAgICB0aGlzLl9kZWxldGVDYXJkKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gZXZ0ID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1jbG9zZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBldnQgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCAhPT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHsgZm9ybVN1Ym1pdCB9KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm1TdWJtaXQgPSBmb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19jb250YWluZXJcIik7XHJcbiAgfVxyXG4gIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IChpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGV2dCA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9mb3JtU3VibWl0KHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBsb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcItCh0L7RhdGA0LDQvdC10L3QuNC1Li4uXCI7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBmb3JtUHJvZmlsZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9wb3B1cF9hZGQtY2FyZFwiKTtcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fY29udGFpbmVyX3R5cGVfbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19jb250YWluZXJfdHlwZV9pbmZvXCIpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBidXR0b25DYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGRidXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJrYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5leHBvcnQgY29uc3QgZm9ybUF2YXRhcmthID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX3BvcHVwX2F2YXRhclwiKTtcclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBmb3JtOiBcIi5mb3JtXCIsXHJcbiAgc3VtYml0QnV0dG9uOiBcIi5mb3JtX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9pbnZhbGlkXCIsXHJcbn07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZm9ybVByb2ZpbGVFZGl0LFxyXG4gIGZvcm1BZGRDYXJkLFxyXG4gIG5hbWVJbnB1dCxcclxuICBqb2JJbnB1dCxcclxuICBidXR0b25Qcm9maWxlLFxyXG4gIGJ1dHRvbkNhcmQsXHJcbiAgYXZhdGFya2EsXHJcbiAgZm9ybUF2YXRhcmthLFxyXG4gIGNvbmZpZyxcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy5qc1wiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTQ3XCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIwMTYyYmUzMy0yNmZjLTQ1ODItOTdlOC0wZDc4ZjRhZDIwZDFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8vINCj0LLQtdC70LjRh9C10L3QvdCw0Y8g0LrQsNGA0YLQuNC90LrQsFxyXG5cclxuY29uc3QgYmlnSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfb3Blbi1pbWdcIik7XHJcblxyXG4vLy8vINGD0LTQsNC70LXQvdC40LVcclxuXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwRGVsZXRlKFwiLnBvcHVwX3R5cGVfZGVsZXRlXCIpO1xyXG5cclxuLy8vINC/0YDQvtGE0LjQu9GMXHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgcHJvZmlsZU5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgcHJvZmlsZUluZm86IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXHJcbiAgcHJvZmlsZUF2YXRhcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9wcm9maWxlXCIsIHtcclxuICBmb3JtU3VibWl0OiBkYXRhID0+IHtcclxuICAgIHBvcHVwRm9ybS5sb2FkaW5nKHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlckluZm8oZGF0YSlcclxuICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXN1bHQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxucG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBvcGVuUHJvZmlsZSA9ICgpID0+IHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcclxuICBqb2JJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xyXG4gIHBvcHVwRm9ybS5vcGVuKCk7XHJcbn07XHJcblxyXG4vLy8g0LrQsNGA0YLQvtGH0LrQuFxyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IGl0ZW0gPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgZGF0YTogaXRlbSxcclxuICAgICAgdXNlcklkOiB1c2VySWQsXHJcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKG5hbWUsIGxpbmspID0+IHtcclxuICAgICAgICBiaWdJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgICB9LFxyXG4gICAgICBoYWRsZUxpa2VDbGljazogY2FyZElkID0+IHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5wdXRMaWtlKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmhhbmRsZUxpa2VDYXJkKGRhdGEpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhZGxlRGlzTGlrZUNsaWNrOiBjYXJkSWQgPT4ge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZUxpa2UoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuaGFuZGxlTGlrZUNhcmQoZGF0YSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlRGVsZXRlQ2FyZDogY2FyZElkID0+IHtcclxuICAgICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgICAgICAgZGVsZXRlUG9wdXAuc3VibWl0SGFuZGxlKCgpID0+IHtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICBkZWxldGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZChjYXJkKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgXCIjY2FyZFwiXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgY2FyZExpc3QuYWRkSXRlbVByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUFkZENhcmRGb3JtID0gKCkgPT4ge1xyXG4gIGFkZENhcmQub3BlbigpO1xyXG59O1xyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogaXRlbSA9PiB7XHJcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW1QcmVwZW5kKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmVsZW1lbnRzXCJcclxuKTtcclxuXHJcbmNvbnN0IGFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hZGRfY2FyZFwiLCB7XHJcbiAgZm9ybVN1Ym1pdDogZGF0YSA9PiB7XHJcbiAgICBhZGRDYXJkLmxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZENhcmQoZGF0YSlcclxuICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICBjcmVhdGVDYXJkKHJlc3VsdCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8vINCw0LLQsNGC0LDRgFxyXG5cclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyXCIsIHtcclxuICBmb3JtU3VibWl0OiBkYXRhID0+IHtcclxuICAgIHByb2ZpbGVBdmF0YXIubG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuc2V0VXNlckF2YXRhcihkYXRhKVxyXG4gICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzdWx0KTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSxcclxufSk7XHJcblxyXG4vLy/QstCw0LvQuNC00LDRhtC40Y9cclxuXHJcbmNvbnN0IGZvcm1BZGRWYWxpZCA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUFkZENhcmQpO1xyXG5mb3JtQWRkVmFsaWQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZm9ybVByb2ZpbGVWYWxpZCA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybVByb2ZpbGVFZGl0KTtcclxuZm9ybVByb2ZpbGVWYWxpZC5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBmb3JtQXZhdGFyVmFsaWQgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1BdmF0YXJrYSk7XHJcbmZvcm1BdmF0YXJWYWxpZC5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLy/Qt9Cw0L/RgNC+0YFcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pLnRoZW4ocmVzdWx0ID0+IHtcclxuICBjb25zdCBbaXRlbXMsIHVzZXJEYXRhXSA9IHJlc3VsdDtcclxuICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgY2FyZExpc3QucmVuZGVySXRlbXMoaXRlbXMucmV2ZXJzZSgpKTtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YSk7XHJcbn0pO1xyXG5cclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucHJvZmlsZUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hZGRDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmJpZ0ltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmJ1dHRvblByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9maWxlKTtcclxuYnV0dG9uQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQ2FyZEZvcm0pO1xyXG5hdmF0YXJrYS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVBdmF0YXIub3BlbigpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0VXNlckluZm8oKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBlZGl0VXNlckluZm8oZGF0YSkge1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRVc2VyQXZhdGFyKGRhdGEpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBhZGRDYXJkKGRhdGEpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgcHV0TGlrZShjYXJkSWQpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gICAgdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BpY3R1cmVQb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wb3B1cFN1YnRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VidGl0bGVcIik7XHJcbiAgfVxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdXBTdWJ0aXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9waWN0dXJlUG9wdXBJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcGljdHVyZVBvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgfVxyXG4gIHN1Ym1pdEhhbmRsZShyZW1vdikge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gcmVtb3Y7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBldnQgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVJbmZvLCBwcm9maWxlQXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZSk7XHJcbiAgICB0aGlzLl9wcm9maWxlSW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUluZm8pO1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhcik7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fcHJvZmlsZUluZm8udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh1c2VySW5mbykge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xyXG4gICAgdGhpcy5fcHJvZmlsZUluZm8udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKGRhdGEpIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGFkZEl0ZW1BcHBlbmQoZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcclxuICB9XHJcbiAgYWRkSXRlbVByZXBlbmQoZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtIiwidGhpcyIsIl9mb3JtIiwiX3N1bWJpdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJzdW1iaXRCdXR0b24iLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfc2V0Q3VzdG9tRXJyb3IiLCJpbnB1dCIsInZhbGlkaXR5Iiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJ0b29TaG9ydCIsInRvb0xvbmciLCJjdXJyZW50TGVuZ3RoIiwidmFsdWUiLCJsZW5ndGgiLCJtaW4iLCJnZXRBdHRyaWJ1dGUiLCJfc2V0RmllbGRFcnJvciIsImRvY3VtZW50IiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3NldEJ1dHRvblN0YXRlIiwiY2hlY2tWYWxpZGl0eSIsImNsYXNzTGlzdCIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIl9kaXNhYmxlQnV0dG9uU3RhdGUiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJfaGFuZGxlRm9ybVN1bWJpdCIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX2hhbmRsZUZvcm1JbnB1dCIsInRhcmdldCIsImVuYWJsZVZhbGlkYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiQ2FyZCIsImRhdGEiLCJ1c2VySWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYWRsZUxpa2VDbGljayIsImhhZGxlRGlzTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRTZWxlY3RvciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRPd25lcklkIiwib3duZXIiLCJfaWQiLCJfdXNlcklkIiwiX2NhcmRJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFkbGVMaWtlQ2xpY2siLCJfaGFkbGVEaXNMaWtlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwicmVtb3ZlQ2FyZCIsIl9jYXJkIiwiX9GBYXJkTGlrZSIsInNvbWUiLCJ1c2VyIiwiX2xpa2VCdXR0b24iLCJoYW5kbGVMaWtlQ2FyZCIsIl9saWtlc0NvdW50ZXIiLCJ0b2dnbGUiLCJfZGVsZXRlQ2FyZCIsIl9kZWxldGVCdXR0b24iLCJfc2V0RXZlbnRMaXN0bmVycyIsImNvbnRhaW5zIiwiX2ltYWdlIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiY2xvc2UiLCJiaW5kIiwiX2hhbmRsZUVzY0Nsb3NlIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiZm9yRWFjaCIsInJlc2V0IiwibG9hZGluZyIsImlzTG9hZGluZyIsImZvcm1Qcm9maWxlRWRpdCIsImZvcm1BZGRDYXJkIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJidXR0b25Qcm9maWxlIiwiYnV0dG9uQ2FyZCIsImF2YXRhcmthIiwiZm9ybUF2YXRhcmthIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImF2YXRhciIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJiaWdJbWFnZSIsIl9waWN0dXJlUG9wdXBJbWFnZSIsIl9wb3B1cFN1YnRpdGxlIiwiZGVsZXRlUG9wdXAiLCJzdWJtaXRIYW5kbGUiLCJyZW1vdiIsIl9oYW5kbGVTdWJtaXQiLCJ1c2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUluZm8iLCJwcm9maWxlQXZhdGFyIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVJbmZvIiwiX3Byb2ZpbGVBdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsInBvcHVwRm9ybSIsImVkaXRVc2VySW5mbyIsInRoZW4iLCJyZXN1bHQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVDYXJkIiwiaXRlbSIsImNhcmQiLCJwdXRMaWtlIiwicmVtb3ZlTGlrZSIsImRlbGV0ZUNhcmQiLCJjYXJkRWxlbWVudCIsImNhcmRMaXN0IiwiYWRkSXRlbVByZXBlbmQiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJhZGRJdGVtQXBwZW5kIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmQiLCJhZGRDYXJkIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwidXNlckRhdGEiLCJyZXZlcnNlIl0sInNvdXJjZVJvb3QiOiIifQ==